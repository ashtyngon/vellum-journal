@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── Theme CSS custom properties ─────────────────────────────── */
:root {
  /* Semantic colors — light mode */
  --color-primary: #ec7f13;
  --color-bg: #f8f7f6;
  --color-surface: #fffefc;
  --color-paper: #fffefb;
  --color-ink: #1b140d;
  --color-ink-light: #9a734c;
  --color-pencil: #78716c;
  --color-border: #e8e0d5;
  --shadow-soft: 0 4px 20px -2px rgba(27, 20, 13, 0.08);

  /* Accent (overridden by Color of the Day) */
  --color-accent: hsl(24, 85%, 50%);
  --color-accent-h: 24;
  --color-accent-s: 85%;
  --color-accent-l: 50%;
}

/* Dark mode — flips all semantic tokens */
.dark {
  --color-primary: #f0a050;
  --color-bg: #141210;
  --color-surface: #1e1b18;
  --color-paper: #1a1816;
  --color-ink: #ede8e3;
  --color-ink-light: #c4a882;
  --color-pencil: #a8a29e;
  --color-border: #2a2520;
  --shadow-soft: 0 4px 20px -2px rgba(0, 0, 0, 0.3);
  color-scheme: dark;
}

@layer utilities {
    .bg-wood-texture {
        background-color: #f3ede7;
        position: relative;
        overflow: hidden;
    }
    .bg-wood-texture::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: url(https://lh3.googleusercontent.com/aida-public/AB6AXuDcZ2cPvK_-yOR5SMyQCt01ghDz7Nmd5wkADyS2l99DevJZzQ-ErEBBXfKfoPcqy5qRWpGmJdsHN72nNP5nSo-7Ek0rczMiPWn-wA5bWOzwq0txA_LjJGkvudQ_ffS1fcYwm2dcQQEleXC2GaeCthy4IuE2m-pNcMjAk2aElf3wqBM2fDwV4Qu5XPuBIN5l4o0lTu5wgHUai3m7FPJoM2S8aj05zRotgPpP-AwZcmq13dkEOWqJ8aoP4ISzVTZF3DnG0t9Zeqps7xs);
        background-size: cover;
        filter: blur(2px) contrast(90%) sepia(30%);
        opacity: 0.6;
        mix-blend-mode: multiply;
        z-index: 0;
        pointer-events: none;
    }
    .dark .bg-wood-texture::before {
        filter: blur(2px) brightness(40%) sepia(20%);
        opacity: 0.8;
    }

    .spine-ridge {
        background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.1) 40%, rgba(255, 255, 255, 0.1) 60%, transparent);
    }

    .shelf-shadow {
        background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1), transparent);
    }

    .book-gutter {
        background: linear-gradient(to right, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.2) 40%, rgba(0, 0, 0, 0.25) 50%, rgba(0, 0, 0, 0.2) 60%, rgba(0, 0, 0, 0.05) 100%);
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .clip-path-slant {
        clip-path: polygon(0 0, 100% 20%, 100% 100%, 0% 100%);
    }

    .bg-grain {
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.08'/%3E%3C/svg%3E");
    }

    .bg-texture-vellum {
        background-color: #F9F5F0;
        background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239a734c' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    .washi-tape {
        background-color: rgba(236, 127, 19, 0.2);
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        mask-image: url("data:image/svg+xml,%3Csvg width='200' height='40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h200v40H0z' fill='%23fff'/%3E%3C/svg%3E");
        -webkit-mask-image: linear-gradient(90deg, transparent 0%, #000 5%, #000 95%, transparent 100%);
    }

    .polaroid-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background-color: #ffffff;
        background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
    }

    .bg-vellum-texture {
        background-color: #FDFBF7;
        background-image:
            url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.08'/%3E%3C/svg%3E"),
            radial-gradient(#e5e0d8 1px, transparent 1px);
        background-size: 200px 200px, 24px 24px;
    }
    .dark .bg-vellum-texture {
        background-color: #1c1917;
        background-image:
            radial-gradient(#292524 1.5px, transparent 1.5px);
        background-size: 24px 24px;
    }

    .paper-texture {
        background-color: #F9F5F0;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
    }

    .bg-noise {
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
    }

    /* Companion tap reactions — randomly chosen */
    @keyframes companionTap {
      0%   { transform: scale(1) rotate(0deg); }
      15%  { transform: scale(1.3) rotate(-8deg); }
      30%  { transform: scale(0.85) rotate(5deg); }
      45%  { transform: scale(1.15) rotate(-3deg); }
      60%  { transform: scale(0.95) rotate(1deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    @keyframes companionSpin {
      0%   { transform: scale(1) rotate(0deg); }
      30%  { transform: scale(1.15) rotate(200deg); }
      60%  { transform: scale(0.9) rotate(340deg); }
      100% { transform: scale(1) rotate(360deg); }
    }
    @keyframes companionFlip {
      0%   { transform: scaleY(1); }
      25%  { transform: scaleY(-1) translateY(-4px); }
      50%  { transform: scaleY(1) translateY(-8px); }
      75%  { transform: scaleY(1) translateY(-2px); }
      100% { transform: scaleY(1) translateY(0); }
    }
    @keyframes companionWiggle {
      0%, 100% { transform: translateX(0); }
      10% { transform: translateX(-6px) rotate(-5deg); }
      20% { transform: translateX(6px) rotate(5deg); }
      30% { transform: translateX(-4px) rotate(-3deg); }
      40% { transform: translateX(4px) rotate(3deg); }
      50% { transform: translateX(-2px) rotate(-1deg); }
      60% { transform: translateX(2px) rotate(1deg); }
      70% { transform: translateX(0); }
    }
    @keyframes companionFloat {
      0%   { transform: translateY(0) scale(1); }
      40%  { transform: translateY(-16px) scale(1.15); }
      70%  { transform: translateY(-8px) scale(1.05); }
      100% { transform: translateY(0) scale(1); }
    }
    @keyframes companionGrow {
      0%   { transform: scale(1); filter: brightness(1); }
      30%  { transform: scale(1.5); filter: brightness(1.3); }
      60%  { transform: scale(1.2); filter: brightness(1.1); }
      100% { transform: scale(1); filter: brightness(1); }
    }

    /* Companion celebration when task completed */
    @keyframes companionCelebrate {
      0%   { transform: scale(1) translateY(0); }
      10%  { transform: scale(1.4) translateY(-8px); }
      20%  { transform: scale(1.1) translateY(-14px) rotate(10deg); }
      30%  { transform: scale(1.3) translateY(-6px) rotate(-8deg); }
      40%  { transform: scale(1.05) translateY(-10px) rotate(5deg); }
      55%  { transform: scale(1.2) translateY(-4px) rotate(-3deg); }
      70%  { transform: scale(1.1) translateY(-2px) rotate(1deg); }
      85%  { transform: scale(1.05) translateY(0); }
      100% { transform: scale(1) translateY(0); }
    }

    /* Floating particle from companion click */
    @keyframes companionParticle {
      0%   { opacity: 1; transform: translateY(0) scale(1); }
      50%  { opacity: 0.8; transform: translateY(-20px) scale(1.2); }
      100% { opacity: 0; transform: translateY(-40px) scale(0.6); }
    }

    /* Speech bubble flash on click */
    @keyframes bubbleFlash {
      0%   { border-color: var(--color-primary); box-shadow: 0 0 0 0 var(--color-glow); }
      50%  { border-color: var(--color-primary); box-shadow: 0 0 12px 2px var(--color-glow); }
      100% { border-color: rgba(0,0,0,0.06); box-shadow: none; }
    }

    /* Task completion celebration phrase — flashy entrance, proud hold, gentle exit */
    @keyframes celebrationPhrase {
      0%   { opacity: 0; transform: translate(-50%, 16px) scale(0.7); }
      8%   { opacity: 1; transform: translate(-50%, -4px) scale(1.12); }
      14%  { opacity: 1; transform: translate(-50%, 2px) scale(0.98); }
      20%  { opacity: 1; transform: translate(-50%, 0) scale(1.03); }
      28%  { opacity: 1; transform: translate(-50%, 0) scale(1); }
      72%  { opacity: 1; transform: translate(-50%, 0) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -18px) scale(1.05); }
    }

    /* Walkthrough step transition */
    @keyframes walkthroughFade {
      0%   { opacity: 0; transform: translateY(12px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    /* Multi-line truncation */
    .truncate-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    /* Scrollbars */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    .horizontal-scroll::-webkit-scrollbar {
        height: 8px;
    }
    .horizontal-scroll::-webkit-scrollbar-track {
        background: transparent;
    }
    .horizontal-scroll::-webkit-scrollbar-thumb {
        background-color: #D4A373;
        border-radius: 4px;
        opacity: 0.5;
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: #e5e0dc;
        border-radius: 20px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: #d1cdc9;
    }
}
